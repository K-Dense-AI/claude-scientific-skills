먼저 ~/.claude/commands/research-commons.md 파일을 읽고 공통 규칙(인용 스타일, Storage 키 체계, 스킬 간 연동, 트리거 분기)을 숙지한 후 아래 스킬을 실행하세요.

---

# Experiment Hub (실험 허브)

실험 프로토콜 관리, 조건 최적화, 실험 제안, 이력 기록, 데이터 시각화, 양상 분석, 실험 비교를 위한 통합 스킬.

## 모드 판별 → 실행

사용자 요청에서 모드를 판별하여 해당 절차를 실행한다.

| 모드 | 트리거 예 | 핵심 절차 |
|------|----------|----------|
| **1. 프로토콜** | "프로토콜 만들어" | 목적 확인 → 메소드 참조 검색(research-assistant M4 자동 호출) → 템플릿 작성 → 조건 입력 |
| **2. 최적화** | "전환율 높이려면?" | 현재 데이터 → 목표/변수 선정 → 전략 선택(OFAT/DoE/RSM) → 실험 매트릭스 생성 |
| **3. 제안** | "다음 실험 뭐 하지?" | 갭 분석 → 문헌 참조 → 우선순위별 실험 제안 → 수락 시 모드 1 연계 |
| **4. 기록** | "결과 기록해줘" | 조건/결과 구조화 → 이상치 감지 → 동일 프로토콜 이전 실험 있으면 비교 제안 |
| **5. 시각화** | "그래프 그려줘" | 데이터→그래프 생성 / 이미지→데이터 추출 + 추세선 자동 피팅 |
| **6. 양상분석** | "왜 이런 결과?" | 변수-결과 매핑 → 양상 분류 → 추세선 정량분석 → 변인별 해석 → 인과관계 평가 |
| **7. 비교** | "이전 실험이랑 비교" | 변경 변수 식별 → 결과 비교표 → Δ값 계산 → 추세 그래프 → 차이 원인 분석 |

**체인 자동 연계**: 기록(4) → 비교(7) → 양상분석(6) → 시각화(5) → 최적화(2)

> **분기 기준** (COMMONS.md): 데이터/통계 = 여기(M6/M7), 메커니즘/맥락 = research-discussion(M1/M2)

---

## 모드 1: 프로토콜 — 메소드 참조 자동 검색

프로토콜 작성 시 자동으로 3가지 카테고리를 검색하여 조건 근거를 확보한다:

| 카테고리 | 검색 대상 | 반영 항목 |
|---------|----------|----------|
| 논문 메소드 | 유사 반응 논문의 실험 방법 | 반응 조건, 시간, 농도 |
| 분석 프로토콜 | HPLC/GC/UV 분석 조건, 키트 매뉴얼 | 이동상, 컬럼, 검출 파장 |
| 제조사 데이터시트 | 효소/시약 최적 조건 | 최적 온도/pH, 활성 단위 |

- 검색 결과는 **기본값 제안**이지 강제 적용 아님
- 사용자가 다른 조건 선택 시 "참조 대비 변경"으로 명시
- 출처를 프로토콜에 기록 (추후 인용 가능)

프로토콜 형식: ID(PROT-{N}), 버전, 참조 메소드, 재료, 방법(Step별), 분석, 안전/폐기, 변경 이력 포함.

---

## 모드 2: 최적화 전략 선택 기준

| 조건 | 전략 |
|------|------|
| 변수 1–2개, 병목 명확 | OFAT |
| 변수 3–4개, 상호작용 의심 | Full/Fractional Factorial DoE |
| 변수 3개+, 최적점 탐색 | RSM / Central Composite Design |

출력: 최적화 변수(범위/현재값), 실험 매트릭스(Run별 조건+목적), 예상 실험 수/기간.

---

## 모드 5: 추세선 자동 선택 규칙

| 데이터 패턴 | 추세선 유형 |
|------------|-----------|
| 단조 증가/감소 | 선형 회귀 (y = ax + b) |
| 포화/정체 곡선 | 비선형 (Michaelis-Menten 등) |
| 최적점 존재 | 2차 다항식 |
| 지수적 변화 | 지수 피팅 |
| 포인트 < 3 또는 R² < 0.5 | 추세선 미적용 |

필수 출력: 방정식, R², 주요 지점(최대값/포화점/변곡점).

---

## 모드 6: 양상 분류 기준

- **증가** (양의 상관): 선형 / 수확체감
- **감소** (음의 상관): 선형 / 역치 급락
- **최적점**: 좌우 대칭/비대칭
- **정체/포화**: 포화 도달 vs 반응 제한
- **이상치**: 실험 오류 vs 새로운 현상

인과관계 강도: ★★★★★(용량-반응+메커니즘+재현) ~ ★☆☆☆☆(데이터 부족)

---

## 스킬 간 연동

- exp:log → research-discussion 해석(M1)
- exp:pattern → research-discussion 비교(M2)
- disc:action → 프로토콜 생성(M1)
- 실험 제안(M3) → research-assistant 검색(M1)
- exp:result/viz → manuscript-writer Results/Figure
- ms:revision → 추가실험 프로토콜(M1) 트리거

## 생명공학 실험 특화

- **효소 반응**: 기질 준비 → 효소 첨가 → 반응 → 샘플링 → 분석
- **다효소 캐스케이드**: 효소별 최적 조건 매트릭스
- **전세포 촉매**: OD, 투과화, 공기 조건 포함

## 주의사항

- 최적화 제안은 통계적 제안이며, 실험적 검증이 필수
- 추세선 외삽은 신뢰도 낮음을 항상 명시
- 그래프→수치 추출은 근사값, 원본 확인 권장

사용자 요청: $ARGUMENTS
