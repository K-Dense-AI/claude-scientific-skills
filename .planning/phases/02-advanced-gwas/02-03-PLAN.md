---
phase: 02-advanced-gwas
plan: 03
type: execute
wave: 2
depends_on: [02-01, 02-02]
files_modified:
  - scientific-skills/qtl-analysis/examples/genomic-control/run_genomic_control.py
  - scientific-skills/qtl-analysis/examples/genomic-control/README.md
  - scientific-skills/qtl-analysis/examples/genomic-control/output/
  - scientific-skills/qtl-analysis/examples/rare-variant-tests/run_rare_variants.py
  - scientific-skills/qtl-analysis/examples/rare-variant-tests/README.md
  - scientific-skills/qtl-analysis/examples/rare-variant-tests/output/
autonomous: true
requirements:
  - QTLGW-05
  - QTLGW-06
must_haves:
  truths:
    - "User can run genomic control and see lambda adjustment on QQ plots"
    - "User can run rare variant burden and SKAT-like set tests"
    - "READMEs explain when these methods are needed"
---

<objective>
Create genomic control and rare variant association examples with runnable scripts, committed outputs, and interpretable reports.
</objective>

<tasks>
<task type="auto">
<name>Task 1: Build genomic control example</name>
<action>Create `examples/genomic-control/` with script that computes inflation factor lambda, applies genomic control adjustment, and writes before/after QQ plots plus CSV output.</action>
<verify>python scientific-skills/qtl-analysis/examples/genomic-control/run_genomic_control.py</verify>
<done>Outputs include QQ plot before/after and lambda summary.</done>
</task>

<task type="auto">
<name>Task 2: Build rare variant tests example</name>
<action>Create `examples/rare-variant-tests/` with script that simulates rare variants and runs burden and SKAT-like set tests, producing result tables and comparison plots.</action>
<verify>python scientific-skills/qtl-analysis/examples/rare-variant-tests/run_rare_variants.py</verify>
<done>Outputs include per-gene rare variant association table and method comparison plot.</done>
</task>

<task type="auto">
<name>Task 3: Write READMEs</name>
<action>Write Input→Process→Output READMEs for both examples with practical interpretation guidance.</action>
<verify>python -m py_compile scientific-skills/qtl-analysis/examples/genomic-control/run_genomic_control.py scientific-skills/qtl-analysis/examples/rare-variant-tests/run_rare_variants.py</verify>
<done>Both READMEs and scripts are complete and validated.</done>
</task>
</tasks>
